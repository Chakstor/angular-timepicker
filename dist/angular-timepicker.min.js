/*! angular-timepicker 1.0.10 | (c) 2016, Geta AS | MIT (http://www.opensource.org/licenses/MIT) */
!function(a){"use strict";a.module("dnTimepicker",["ui.bootstrap.position","dateParser"]).factory("dnTimepickerHelpers",function(){return{stringToMinutes:function(a){if(!a)return null;var b=a.match(/(\d+)(h?)/);return b[1]?b[1]*(b[2]?60:1):null},buildOptionList:function(b,c,d){for(var e=[],f=a.copy(b);c>=f;)e.push(new Date(f)),f.setMinutes(f.getMinutes()+d);return e},getClosestIndex:function(b,c){if(!a.isDate(b))return-1;for(var d=null,e=-1,f=60*b.getHours()+b.getMinutes(),g=0;g<c.length;g++){var h=c[g],i=60*h.getHours()+h.getMinutes();(null===d||Math.abs(i-f)<Math.abs(d-f))&&(d=i,e=g)}return e}}}).directive("dnTimepicker",["$compile","$parse","$uibPosition","$document","dateFilter","$dateParser","dnTimepickerHelpers","$log","$timeout",function(b,c,d,e,f,g,h,i,j){return{restrict:"A",require:"ngModel",scope:{ngModel:"=",onSelect:"="},link:function(c,k,l,m){function n(b){return r||(r=a.isDate(c.ngModel)?c.ngModel:new Date),r.setHours(b.getHours()),r.setMinutes(b.getMinutes()),r.setSeconds(b.getSeconds()),c.onSelect(b),o(r),r}function o(b){a.isDate(b)||(b=g(c.ngModel,c.timepicker.timeFormat),isNaN(b)&&i.warn("Failed to parse model.")),r=b}function p(a){var b=parseInt(Number(a)),c=Math.round(60*(Number(a)-b)),d=new Date;return d.setHours(b),d.setMinutes(c),d}var q=!1;k.on("click",function(){var a=this;q||(q=!0,j(function(){a.setSelectionRange(0,a.value.length)},0))}).on("blur",function(){q=!1});var r=null,s=[],t=!0;c.timepicker={element:null,timeFormat:"H:mm",minTime:g("0:00","H:mm"),maxTime:g("23:30","H:mm"),step:30,isOpen:!1,activeIdx:-1,optionList:function(){return t&&(s=h.buildOptionList(c.timepicker.minTime,c.timepicker.maxTime,c.timepicker.step),t=!1),s}},l.$observe("dnTimepicker",function(a){a&&(c.timepicker.timeFormat=a),m.$render()}),l.$observe("minTime",function(a){a&&(c.timepicker.minTime=g(a,c.timepicker.timeFormat),t=!0)}),l.$observe("maxTime",function(a){a&&(c.timepicker.maxTime=g(a,c.timepicker.timeFormat),t=!0)}),l.$observe("step",function(a){if(a){var b=h.stringToMinutes(a);b&&(c.timepicker.step=b),t=!0}}),c.$watch("ngModel",function(a){o(a),m.$render()}),m.$render=function(){k.val(a.isDate(r)?f(r,c.timepicker.timeFormat):m.$viewValue?m.$viewValue:"")},m.$parsers.unshift(function(b){c.viewValue=b;var d=a.isDate(b)?b:g(b,c.timepicker.timeFormat);return isNaN(d)?void m.$setValidity("time",!1):(m.$setValidity("time",!0),n(d))}),c.select=function(b){a.isDate(b)&&(m.$setViewValue(n(b)),m.$render())},c.isActive=function(a){return a===c.timepicker.activeIdx},c.setActive=function(a){},c.scrollToSelected=function(){if(c.timepicker.element&&c.timepicker.activeIdx>-1){var a=c.timepicker.element[0].querySelector(".active");a.parentNode.scrollTop=a.offsetTop-50}},c.openPopup=function(){c.position=d.position(k),c.position.top=c.position.top+k.prop("offsetHeight"),c.timepicker.isOpen=!0,c.$digest(),c.scrollToSelected()},c.closePopup=function(){c.timepicker.isOpen&&(c.timepicker.isOpen=!1,c.$apply(),k[0].blur())},k.after(b(a.element("<div dn-timepicker-popup></div>"))(c)),k.bind("focus",function(){c.openPopup()}).bind("blur",function(){c.viewValue&&!a.isDate(g(c.viewValue,c.timepicker.timeFormat))&&(isNaN(c.viewValue)?c.select(c.timepicker.optionList()[0]):a.isDate(c.viewValue)?c.select(c.viewValue):c.select(p(c.viewValue))),setTimeout(function(){c.closePopup()},100)}).bind("keypress keyup",function(b){38===b.which&&c.timepicker.activeIdx>0?(c.timepicker.activeIdx--,c.scrollToSelected()):40===b.which&&c.timepicker.activeIdx<c.timepicker.optionList().length-1?(c.timepicker.activeIdx++,c.scrollToSelected()):13===b.which&&c.timepicker.activeIdx>-1?(c.select(c.timepicker.optionList()[c.timepicker.activeIdx]),c.closePopup()):13===b.which&&c.viewValue&&!a.isDate(g(c.viewValue,c.timepicker.timeFormat))&&(isNaN(c.viewValue)||(a.isDate(c.viewValue)?c.select(c.viewValue):c.select(p(c.viewValue)),c.closePopup())),c.$digest()}),e.bind("click",function(a){c.timepicker.isOpen&&a.target!==k[0]&&c.closePopup()}),o(c.ngModel)}}}]).directive("dnTimepickerPopup",function(){return{restrict:"A",replace:!0,transclude:!1,template:'<ul class="dn-timepicker-popup dropdown-menu" ng-style="{display: timepicker.isOpen && \'block\' || \'none\', top: position.top+\'px\', left: position.left+\'px\'}"><li ng-repeat="time in timepicker.optionList()" ng-class="{active: isActive($index) }" ng-mouseenter="setActive($index)"><a ng-click="select(time)">{{time | date:timepicker.timeFormat}}</a></li></ul>',link:function(a,b,c){a.timepicker.element=b,b.find("a").bind("click",function(a){a.preventDefault()})}}})}(angular);
//# sourceMappingURL=angular-timepicker.min.js.map